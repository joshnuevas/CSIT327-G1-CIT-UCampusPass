{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}CIT-U Campus Pass{% endblock %}</title>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
  />
  <link
    rel="stylesheet"
    href="{% static 'dashboard_app/css/dashboard.css' %}?v={{ now|date:'U' }}"
  />
  <style>
        body {
        overflow-x: hidden;
        position: relative;
        }

        /* ===== MENU TOGGLE ===== */
        .menu-toggle {
        display: none;
        background: none;
        border: none;
        font-size: 1.8rem;
        color: #8b1538;
        cursor: pointer;
        margin-right: 10px;
        z-index: 1201;
        position: relative;
        }

        /* ===== SIDEBAR ===== */
        .sidebar {
        width: 260px;
        background: linear-gradient(180deg, #8b1538 0%, #6b0f2a 100%);
        color: #fff;
        height: 100%;
        position: fixed;
        top: 0;
        left: 0;
        border-right: 2px solid #6b0f2a;
        transition: transform 0.35s ease;
        z-index: 1300;
        transform: translateX(0);
        box-shadow: 4px 0 15px rgba(0, 0, 0, 0.15);
        }

        .sidebar-header {
        text-align: center;
        padding: 30px 15px 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .sidebar-header h2 {
        color: #fff;
        font-size: 18px;
        margin-bottom: 5px;
        }

        .sidebar-header p {
        color: #f2dede;
        font-size: 14px;
        }

        .nav-menu {
        display: flex;
        flex-direction: column;
        margin-top: 20px;
        }

        .nav-item {
        padding: 14px 22px;
        color: #fff;
        text-decoration: none;
        display: flex;
        align-items: center;
        font-size: 15px;
        transition: background 0.3s ease, padding-left 0.3s ease;
        }

        .nav-item:hover,
        .nav-item.active {
        background: rgba(255, 255, 255, 0.15);
        }

        .nav-item i {
        width: 22px;
        margin-right: 12px;
        color: #f5d36a;
        }

        .nav-divider {
        margin: 20px 0;
        border-top: 1px solid rgba(255, 255, 255, 0.25);
        }

        /* ===== MOBILE SIDEBAR ===== */
        @media (max-width: 1100px) {
        .sidebar {
            transform: translateX(-100%);
        }

        .sidebar.active {
            transform: translateX(0);
        }

        .menu-toggle {
            display: inline-block;
        }

        .main-content {
            margin-left: 0 !important;
        }
        }

        /* ===== OVERLAY ===== */
        .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.45);
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
        z-index: 1200;
        }

        .overlay.active {
        opacity: 1;
        visibility: visible;
        }

        /* ===== TOP BAR ===== */
        .top-bar {
        background: transparent;
        border-bottom: 2px solid #8b1538;
        box-shadow: none;
        padding: 18px 35px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: sticky;
        top: 0;
        z-index: 110;
        flex-wrap: wrap;
        }

        .search-bar {
        flex: 1;
        min-width: 220px;
        max-width: 500px;
        transition: max-width 0.3s ease;
        }

        .search-bar input {
        width: 100%;
        background: #fff;
        border: 2px solid #e0e0e0;
        border-radius: 30px;
        padding: 12px 18px;
        transition: 0.3s;
        }

        .search-bar input:focus {
        border-color: #8b1538;
        box-shadow: 0 0 0 3px rgba(139, 21, 56, 0.1);
        outline: none;
        }

        /* Smaller search bar on mobile */
        @media (max-width: 768px) {
        .search-bar {
            max-width: 300px;
            margin-top: 8px;
        }
        }

        /* ===== ICON AREA ===== */
        .user-info {
        position: relative;
        display: flex;
        align-items: center;
        gap: 10px; /* reduced gap */
        }

        .notification-icon {
        position: relative;
        cursor: pointer;
        font-size: 18px;
        color: #8b1538;
        }

        .notification-badge {
        position: absolute;
        top: 3px;
        right: 4px;
        width: 8px;
        height: 8px;
        background: red;
        border-radius: 50%;
        display: none;
        }

        /* ===== DROPDOWNS ===== */
        .dropdown {
        position: absolute;
        top: 70px;
        right: 0;
        background: #fff;
        border-radius: 14px;
        box-shadow: 0 10px 28px rgba(0, 0, 0, 0.15);
        display: none;
        width: 270px;
        z-index: 1400;
        overflow: hidden;
        animation: fadeIn 0.25s ease forwards;
        }

        .dropdown.active {
        display: block;
        }

        .dropdown-header {
        padding: 14px 20px;
        font-weight: 600;
        font-size: 15px;
        color: #8b1538;
        border-bottom: 1px solid #eee;
        }

        .dropdown-item {
        padding: 14px 22px;
        font-size: 15px;
        color: #333;
        cursor: pointer;
        border-bottom: 1px solid #f2f2f2;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: background 0.25s ease;
        }

        .dropdown-item:hover {
        background: #fafafa;
        }

        .dropdown-item i {
        color: #8b1538;
        width: 20px;
        }

        .dropdown-empty {
        padding: 20px;
        text-align: center;
        color: #666;
        font-size: 14px;
        }

        @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(-8px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
        }

        /* Specific dropdown positions */
        #notifDropdown {
        right: 80px;
        }

        #profileDropdown {
        right: 20px;
        }

    </style>

  {% block extra_css %}{% endblock %}
</head>
<body>
  <!-- ===== OVERLAY ===== -->
  <div class="overlay" id="overlay"></div>

  <!-- ===== SIDEBAR ===== -->
  <div class="sidebar" id="sidebar">
    <div class="school-logo"></div>
    <div class="sidebar-header">
      <h2>CIT-U Campus Pass</h2>
      <p>Administrator Panel</p>
    </div>

    <nav class="nav-menu">
      <a href="{% url 'dashboard_app:admin_dashboard' %}" class="nav-item {% block dashboard_active %}{% endblock %}">
        <i class="fas fa-chart-line"></i> Dashboard
      </a>
      <a href="#" class="nav-item"><i class="fas fa-user-shield"></i> Admin Management</a>
      <a href="{% url 'manage_staff_app:staff_list' %}" class="nav-item {% block staff_active %}{% endblock %}">
        <i class="fas fa-users-cog"></i> Staff Management
      </a>
      <a href="#" class="nav-item"><i class="fas fa-user-friends"></i> Visitor Management</a>
      <a href="#" class="nav-item"><i class="fas fa-calendar-check"></i> Visit Records</a>
      <div class="nav-divider"></div>
      <a href="#" class="nav-item"><i class="fas fa-file-alt"></i> Reports & Logs</a>
      <a href="#" class="nav-item"><i class="fas fa-cogs"></i> System Settings</a>
    </nav>
  </div>

  <!-- ===== MAIN CONTENT ===== -->
  <div class="main-content">
    <div class="top-bar">
      <button class="menu-toggle" id="menuToggle">
        <i class="fas fa-bars"></i>
      </button>

      <div class="search-bar">
        <input type="text" placeholder="Search admin data, staff, visitors..." />
      </div>

      <div class="user-info">
        <div class="notification-icon" id="notifBtn">
          <i class="fas fa-bell"></i>
          <span class="notification-badge" id="notifDot"></span>
        </div>
        <div class="user-avatar" id="profileBtn">
          {{ request.session.admin_first_name|default:"AD"|slice:":2"|upper }}
        </div>
      </div>
    </div>

    <div class="content-area">{% block content %}{% endblock %}</div>
  </div>

  <!-- ===== NOTIFICATION DROPDOWN ===== -->
  <div class="dropdown" id="notifDropdown">
    <div class="dropdown-header">Notifications</div>
    <div class="dropdown-empty">No new notifications</div>
  </div>

  <!-- ===== PROFILE DROPDOWN ===== -->
  <div class="dropdown" id="profileDropdown">
    <div class="dropdown-header">Administrator</div>
    <div class="dropdown-item"><i class="fas fa-user"></i> Profile</div>
    <div class="dropdown-item" id="logoutBtn">
      <i class="fas fa-sign-out-alt"></i> Logout
    </div>
  </div>

  <!-- ===== LOGOUT MODAL ===== -->
  <div id="logoutModal" class="modal">
    <div class="modal-content">
      <h2>Are you sure you want to logout?</h2>
      <div class="modal-buttons">
        <button id="confirmLogout" class="btn-primary">Logout</button>
        <button id="cancelLogout" class="btn-secondary">Cancel</button>
      </div>
    </div>
  </div>

  <script>
    // ===== SIDEBAR TOGGLE =====
    const menuToggle = document.getElementById("menuToggle");
    const sidebar = document.getElementById("sidebar");
    const overlay = document.getElementById("overlay");

    menuToggle.addEventListener("click", () => {
      sidebar.classList.toggle("active");
      overlay.classList.toggle("active");
    });

    overlay.addEventListener("click", () => {
      sidebar.classList.remove("active");
      overlay.classList.remove("active");
    });

    // ===== DROPDOWNS =====
    const notifBtn = document.getElementById("notifBtn");
    const notifDropdown = document.getElementById("notifDropdown");
    const profileBtn = document.getElementById("profileBtn");
    const profileDropdown = document.getElementById("profileDropdown");

    notifBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      notifDropdown.classList.toggle("active");
      profileDropdown.classList.remove("active");
    });

    profileBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      profileDropdown.classList.toggle("active");
      notifDropdown.classList.remove("active");
    });

    document.addEventListener("click", (e) => {
      if (!notifDropdown.contains(e.target) && !notifBtn.contains(e.target))
        notifDropdown.classList.remove("active");
      if (!profileDropdown.contains(e.target) && !profileBtn.contains(e.target))
        profileDropdown.classList.remove("active");
    });

    // ===== LOGOUT =====
    const logoutBtn = document.getElementById("logoutBtn");
    const logoutModal = document.getElementById("logoutModal");
    const confirmLogout = document.getElementById("confirmLogout");
    const cancelLogout = document.getElementById("cancelLogout");

    logoutBtn.onclick = function (e) {
      e.preventDefault();
      profileDropdown.classList.remove("active");
      logoutModal.style.display = "block";
    };
    confirmLogout.onclick = function () {
      window.location.href = "{% url 'login_app:logout' %}";
    };
    cancelLogout.onclick = function () {
      logoutModal.style.display = "none";
    };
    window.onclick = function (e) {
      if (e.target === logoutModal) logoutModal.style.display = "none";
    };
  </script>

  {% block extra_js %}{% endblock %}
</body>
</html>
