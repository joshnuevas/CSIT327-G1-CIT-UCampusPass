{% extends "dashboard_app/visitor_dashboard_base.html" %}
{% load static %}
{% block title %}CIT-U Campus Pass - Dashboard{% endblock %}

{% block dashboard_active %}active{% endblock %}

{% block content %}
<div class="welcome-section">
    <h1>Welcome, {{ user_first_name }}!</h1>
    <p>Here's what's happening with your campus visits today</p>
</div>

<div class="stats-grid">
    <div class="stat-card active-pass-stat">
        <div class="stat-value">{{ active_visits|length }}</div>
        <div class="stat-label">Active Pass</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ upcoming_visits|length }}</div>
        <div class="stat-label">Upcoming Visits</div>
    </div>
    <div class="stat-card total-visits-stat">
        <div class="stat-value">{{ completed_visits_count }}</div>
        <div class="stat-label">Completed Pass</div>
    </div>
</div>

<div class="dashboard-grid">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">My Visit Codes</h3>
            <a href="{% url 'history_app:visit_history' %}" class="view-all">View All →</a>
        </div>

        {% now "Y-m-d" as today %}
        {% for visit in visits %}
            <div class="pass-code-item">
                <div class="pass-code-info">
                    <h4>{{ visit.code }}</h4>
                    <p>{{ visit.display_date }} • {{ visit.formatted_start_time }} - {{ visit.formatted_end_time }} • {{ visit.purpose }}</p>
                </div>
                <span class="pass-status status-{{ visit.status|lower }}">{{ visit.status }}</span>
            </div>
        {% empty %}
            <p>No visits found.</p>
        {% endfor %}

        <div style="margin-top: 20px;">
            <a href="{% url 'book_visit_app:book_visit' %}" class="quick-action-btn">
                <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                </svg>
                Book New Visit
            </a>
        </div>
    </div>

</div>
{% endblock %}